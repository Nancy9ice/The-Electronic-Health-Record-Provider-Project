{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.3", "generated_at": "2024-01-05T04:58:02.828171Z", "invocation_id": "3c464dcb-d658-4d02-b61d-626b4116d990", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.014765Z", "completed_at": "2024-01-05T04:58:01.034753Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.037752Z", "completed_at": "2024-01-05T04:58:01.037752Z"}], "thread_id": "Thread-3", "execution_time": 0.03497600555419922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.dim_date", "compiled": true, "compiled_code": "WITH\r\n    dates_raw AS (\r\n        SELECT\r\n            DATEADD(day, value, CAST('2018-01-01' AS DATE)) AS full_date\r\n        FROM\r\n            generate_series(0, DATEDIFF(day, '2018-01-01', GETDATE()), 1)\r\n    ),\r\n    days_info AS (\r\n        SELECT\r\n            full_date,\r\n            CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(full_date, '_dbt_utils_surrogate_key_null_'))), 2) AS date_key,\r\n            CONVERT(VARCHAR(2), DATEPART(WEEKDAY, full_date)) AS day_of_week,\r\n            CONVERT(VARCHAR(2), DATEPART(MONTH, full_date)) AS month,\r\n            CONVERT(VARCHAR(2), DATEPART(QUARTER, full_date)) AS quarter,\r\n            CONVERT(VARCHAR(3), DATEPART(DAYOFYEAR, full_date)) AS day_of_year,\r\n            CONVERT(VARCHAR(4), DATEPART(YEAR, full_date)) AS year,\r\n            CONVERT(VARCHAR(20), DATENAME(MONTH, full_date)) AS formatted_month_name,\r\n            CONVERT(VARCHAR(10), RIGHT('0' + CONVERT(VARCHAR(2), DAY(full_date)), 2) + '-' + RIGHT('0' + CONVERT(VARCHAR(2), MONTH(full_date)), 2)) AS day_month\r\n        FROM\r\n            dates_raw\r\n    ),\r\n    days_named AS (\r\n        SELECT\r\n            *,\r\n            CASE\r\n                WHEN day_of_week = 1 THEN 'Sunday'\r\n                WHEN day_of_week = 2 THEN 'Monday'\r\n                WHEN day_of_week = 3 THEN 'Tuesday'\r\n                WHEN day_of_week = 4 THEN 'Wednesday'\r\n                WHEN day_of_week = 5 THEN 'Thursday'\r\n                WHEN day_of_week = 6 THEN 'Friday'\r\n                ELSE 'Saturday'\r\n            END AS day_name,\r\n            CASE\r\n                WHEN month = 1 THEN 'January'\r\n                WHEN month = 2 THEN 'February'\r\n                WHEN month = 3 THEN 'March'\r\n                WHEN month = 4 THEN 'April'\r\n                WHEN month = 5 THEN 'May'\r\n                WHEN month = 6 THEN 'June'\r\n                WHEN month = 7 THEN 'July'\r\n                WHEN month = 8 THEN 'August'\r\n                WHEN month = 9 THEN 'September'\r\n                WHEN month = 10 THEN 'October'\r\n                WHEN month = 11 THEN 'November'\r\n                ELSE 'December'\r\n            END AS month_name,\r\n            CASE\r\n                WHEN quarter = 1 THEN '1st Quarter'\r\n                WHEN quarter = 2 THEN '2nd Quarter'\r\n                WHEN quarter = 3 THEN '3rd Quarter'\r\n                ELSE '4th Quarter'\r\n            END AS quarter_name\r\n        FROM\r\n            days_info\r\n    )\r\nSELECT\r\n    date_key,\r\n    full_date,\r\n    day_of_week,\r\n    day_name,\r\n    month,\r\n    month_name,\r\n    quarter,\r\n    quarter_name,\r\n    day_of_year,\r\n    year\r\nFROM\r\n    days_named;", "relation_name": "\"dbt-fabric project\".\"dbo_healthcare\".\"dim_date\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.054741Z", "completed_at": "2024-01-05T04:58:01.065734Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.069732Z", "completed_at": "2024-01-05T04:58:01.069732Z"}], "thread_id": "Thread-3", "execution_time": 0.026985645294189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.stg_healthcare_records", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo\".\"healthcare_data\"\n)\n\n-- Duplicates were removed from the source data\nselect DISTINCT\n    Name as name, \n    cast(Age AS int) as age, \n    \"Gender\" as gender, \n    \"Blood Type\" as blood_type,\n    \"Medical Condition\" as medical_condition, \n    convert(date, \"Date of Admission\") as admission_date,\n    Doctor as doctor,\n    Hospital as hospital,\n    \"Insurance Provider\" as insurance_provider,\n    cast(\"Billing Amount\" as float) as \"billing_amount\",\n    \"Room Number\" as room_number,\n    \"Admission Type\" as admission_type,\n    convert(date, \"Discharge Date\") as discharge_date,\n    Medication as medication,\n    \"Test Results\" as test_results\nfrom source", "relation_name": "\"dbt-fabric project\".\"dbo_staging\".\"stg_healthcare_records\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.079725Z", "completed_at": "2024-01-05T04:58:01.091718Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.096715Z", "completed_at": "2024-01-05T04:58:01.096715Z"}], "thread_id": "Thread-3", "execution_time": 0.023984670639038086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.fct_hospital_revenue", "compiled": true, "compiled_code": "WITH patients AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_staging\".\"stg_healthcare_records\"\n),\ndate_cte AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_healthcare\".\"dim_date\"\n)\n\nSELECT\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(hospital, '_dbt_utils_surrogate_key_null_'))), 2) AS hospital_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(doctor, '_dbt_utils_surrogate_key_null_'))), 2) AS doctor_key,\n    date_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(admission_type, '_dbt_utils_surrogate_key_null_'))), 2) AS admission_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medical_condition, '_dbt_utils_surrogate_key_null_'))), 2) AS diagnosis_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(insurance_provider, '_dbt_utils_surrogate_key_null_'))), 2) AS insurance_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medication, '_dbt_utils_surrogate_key_null_'))), 2) AS medication_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(test_results, '_dbt_utils_surrogate_key_null_'))), 2) AS result_key,\n    full_date as date,\n    hospital,\n    ROUND(SUM(patients.billing_amount), 2) AS total_revenue\nFROM patients\nLEFT JOIN date_cte ON patients.admission_date = date_cte.full_date\nGROUP BY \n        CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(hospital, '_dbt_utils_surrogate_key_null_'))), 2),\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(doctor, '_dbt_utils_surrogate_key_null_'))), 2),\n    date_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(admission_type, '_dbt_utils_surrogate_key_null_'))), 2),\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medical_condition, '_dbt_utils_surrogate_key_null_'))), 2),\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(insurance_provider, '_dbt_utils_surrogate_key_null_'))), 2),\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medication, '_dbt_utils_surrogate_key_null_'))), 2),\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(test_results, '_dbt_utils_surrogate_key_null_'))), 2),\n    full_date,\n    hospital", "relation_name": "\"dbt-fabric project\".\"dbo_healthcare\".\"fct_hospital_revenue\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.109706Z", "completed_at": "2024-01-05T04:58:01.119701Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.123697Z", "completed_at": "2024-01-05T04:58:01.123697Z"}], "thread_id": "Thread-3", "execution_time": 0.020987510681152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.fct_patient_stay", "compiled": true, "compiled_code": "WITH patients AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_staging\".\"stg_healthcare_records\"\n),\ndate_cte AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_healthcare\".\"dim_date\"\n)\n\nSELECT\n    COALESCE(CONVERT(VARCHAR(100), name), '') + '-' +\n    CAST(age AS VARCHAR(10)) + '-' +\n    COALESCE(CONVERT(VARCHAR(10), gender), '') + '-' +\n    COALESCE(CONVERT(VARCHAR(10), blood_type), '') AS patient_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(doctor, '_dbt_utils_surrogate_key_null_'))), 2) AS doctor_key,\n    date_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(admission_type, '_dbt_utils_surrogate_key_null_'))), 2) AS admission_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medical_condition, '_dbt_utils_surrogate_key_null_'))), 2) AS diagnosis_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(insurance_provider, '_dbt_utils_surrogate_key_null_'))), 2) AS insurance_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medication, '_dbt_utils_surrogate_key_null_'))), 2) AS medication_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(test_results, '_dbt_utils_surrogate_key_null_'))), 2) AS result_key,\n    admission_date,\n    discharge_date,\n    DATEDIFF(day, admission_date, discharge_date) AS \"length_of_stay (in days)\"\nFROM patients\nINNER JOIN date_cte ON patients.admission_date = date_cte.full_date\nGROUP BY \n    COALESCE(CONVERT(VARCHAR(100), name), '') + '-' +\n    CAST(age AS VARCHAR(10)) + '-' +\n    COALESCE(CONVERT(VARCHAR(10), gender), '') + '-' +\n    COALESCE(CONVERT(VARCHAR(10), blood_type), ''),\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(doctor, '_dbt_utils_surrogate_key_null_'))), 2),\n    date_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(admission_type, '_dbt_utils_surrogate_key_null_'))), 2),\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medical_condition, '_dbt_utils_surrogate_key_null_'))), 2),\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(insurance_provider, '_dbt_utils_surrogate_key_null_'))), 2),\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medication, '_dbt_utils_surrogate_key_null_'))), 2),\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(test_results, '_dbt_utils_surrogate_key_null_'))), 2),\n    admission_date,\n    discharge_date,\n    DATEDIFF(day, admission_date, discharge_date)", "relation_name": "\"dbt-fabric project\".\"dbo_healthcare\".\"fct_patient_stay\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.137692Z", "completed_at": "2024-01-05T04:58:01.147683Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.150683Z", "completed_at": "2024-01-05T04:58:01.150683Z"}], "thread_id": "Thread-3", "execution_time": 0.021986007690429688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.stg_admissions", "compiled": true, "compiled_code": "WITH patients AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_staging\".\"stg_healthcare_records\"\n)\n\nSELECT\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(admission_type, '_dbt_utils_surrogate_key_null_'))), 2) AS admission_key,\n    admission_type\nFROM patients\nGROUP BY admission_type;", "relation_name": "\"dbt-fabric project\".\"dbo_staging\".\"stg_admissions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.162677Z", "completed_at": "2024-01-05T04:58:01.170671Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.173668Z", "completed_at": "2024-01-05T04:58:01.173668Z"}], "thread_id": "Thread-3", "execution_time": 0.017989397048950195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.stg_diagnosis", "compiled": true, "compiled_code": "with patients as (\n    select * from \"dbt-fabric project\".\"dbo_staging\".\"stg_healthcare_records\"\n)\n\nselect\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medical_condition, '_dbt_utils_surrogate_key_null_'))), 2) AS diagnosis_key,\n    medical_condition as diagnosis\nfrom patients\ngroup by CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medical_condition, '_dbt_utils_surrogate_key_null_'))), 2), \n        medical_condition", "relation_name": "\"dbt-fabric project\".\"dbo_staging\".\"stg_diagnosis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.181663Z", "completed_at": "2024-01-05T04:58:01.190657Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.194655Z", "completed_at": "2024-01-05T04:58:01.194655Z"}], "thread_id": "Thread-3", "execution_time": 0.019989013671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.stg_doctors", "compiled": true, "compiled_code": "WITH patients AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_staging\".\"stg_healthcare_records\"\n)\n\n--  Assuming that one doctor cannot work in multiple hospitals\nSELECT\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(doctor, '_dbt_utils_surrogate_key_null_'))), 2) AS doctor_key,\n    doctor_first_name,\n    doctor_last_name\nFROM (\n    SELECT\n        doctor,\n        CASE WHEN CHARINDEX(' ', COALESCE(CONVERT(VARCHAR(100), doctor), '')) > 0 THEN SUBSTRING(COALESCE(CONVERT(VARCHAR(100), doctor), ''), 1, CHARINDEX(' ', COALESCE(CONVERT(VARCHAR(100), doctor), '')) - 1) ELSE COALESCE(CONVERT(VARCHAR(100), doctor), '') END AS doctor_first_name,\n        CASE WHEN CHARINDEX(' ', COALESCE(CONVERT(VARCHAR(100), doctor), '')) > 0 THEN SUBSTRING(COALESCE(CONVERT(VARCHAR(100), doctor), ''), CHARINDEX(' ', COALESCE(CONVERT(VARCHAR(100), doctor), '')) + 1, LEN(COALESCE(CONVERT(VARCHAR(100), doctor), '')) - CHARINDEX(' ', COALESCE(CONVERT(VARCHAR(100), doctor), ''))) ELSE NULL END AS doctor_last_name,\n        hospital\n    FROM patients\n) AS subquery\nGROUP BY doctor, doctor_first_name, doctor_last_name;", "relation_name": "\"dbt-fabric project\".\"dbo_staging\".\"stg_doctors\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.204648Z", "completed_at": "2024-01-05T04:58:01.211644Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.215642Z", "completed_at": "2024-01-05T04:58:01.215642Z"}], "thread_id": "Thread-3", "execution_time": 0.013990402221679688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.stg_hospitals", "compiled": true, "compiled_code": "WITH patients AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_staging\".\"stg_healthcare_records\"\n)\n\n-- Assuming that multiple hospitals cannot have the same name\nselect\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(hospital, '_dbt_utils_surrogate_key_null_'))), 2) AS hospital_key,\n    hospital as hospital_name\nfrom patients\ngroup by hospital", "relation_name": "\"dbt-fabric project\".\"dbo_staging\".\"stg_hospitals\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.222637Z", "completed_at": "2024-01-05T04:58:01.228633Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.232631Z", "completed_at": "2024-01-05T04:58:01.232631Z"}], "thread_id": "Thread-3", "execution_time": 0.017988920211791992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.stg_insurance_org", "compiled": true, "compiled_code": "WITH patients AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_staging\".\"stg_healthcare_records\"\n)\n\nSELECT\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(insurance_provider, '_dbt_utils_surrogate_key_null_'))), 2) AS insurance_key,\n    insurance_provider\nFROM patients\nGROUP BY insurance_provider;", "relation_name": "\"dbt-fabric project\".\"dbo_staging\".\"stg_insurance_org\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.294596Z", "completed_at": "2024-01-05T04:58:01.312582Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.319579Z", "completed_at": "2024-01-05T04:58:01.319579Z"}], "thread_id": "Thread-3", "execution_time": 0.0439755916595459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.stg_medications", "compiled": true, "compiled_code": "WITH patients AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_staging\".\"stg_healthcare_records\"\n)\n\nSELECT\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medication, '_dbt_utils_surrogate_key_null_'))), 2) AS medication_key,\n    medication, \n    CASE\n        WHEN medication = 'Penicillin' THEN 'Antibiotics'\n        WHEN medication = 'Lipitor' THEN 'Antihyperlipidemics'\n        WHEN medication = 'Aspirin' THEN 'Analgesics'\n        WHEN medication = 'Ibuprofen' THEN 'Analgesics'\n        WHEN medication = 'Paracetamol' THEN 'Analgesics'\n    END AS drug_category\nFROM patients\nGROUP BY medication;", "relation_name": "\"dbt-fabric project\".\"dbo_staging\".\"stg_medications\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.367551Z", "completed_at": "2024-01-05T04:58:01.393533Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.397530Z", "completed_at": "2024-01-05T04:58:01.397530Z"}], "thread_id": "Thread-3", "execution_time": 0.04297494888305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.stg_patient_details", "compiled": true, "compiled_code": "WITH patients AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_staging\".\"stg_healthcare_records\"\n)\n\n-- Assuming that there could be different patients with the same name. The primary key was generated from name, age, gender, and blood_type\nSELECT\n    COALESCE(CONVERT(VARCHAR(100), name), '') + '-' +\n    CAST(age AS VARCHAR(10)) + '-' +\n    COALESCE(CONVERT(VARCHAR(10), gender), '') + '-' +\n    COALESCE(CONVERT(VARCHAR(10), blood_type), '') AS patient_key,\n    name as patient_full_name,\n    SUBSTRING(name, 1, CHARINDEX(' ', name + ' ') - 1) AS patient_first_name,\n    REVERSE(SUBSTRING(REVERSE(name), 1, CHARINDEX(' ', REVERSE(name)) - 1)) AS patient_last_name,\n    age AS patient_age,\n    CASE\n        WHEN age < 1 THEN 'Infant'\n        WHEN age BETWEEN 1 AND 5 THEN 'Toddler'\n        WHEN age BETWEEN 6 AND 12 THEN 'Child'\n        WHEN age BETWEEN 13 AND 17 THEN 'Adolescent'\n        WHEN age BETWEEN 18 AND 64 THEN 'Adult'\n        WHEN age > 64 THEN 'Older Adult'\n    END AS patient_age_category,\n    gender AS patient_gender,\n    blood_type AS patient_blood_type\nFROM patients\nGROUP BY name,\n        age, \n        gender, \n        blood_type", "relation_name": "\"dbt-fabric project\".\"dbo_staging\".\"stg_patient_details\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.510460Z", "completed_at": "2024-01-05T04:58:01.551436Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.557432Z", "completed_at": "2024-01-05T04:58:01.557432Z"}], "thread_id": "Thread-3", "execution_time": 0.06695914268493652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.stg_test_results", "compiled": true, "compiled_code": "WITH patients AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_staging\".\"stg_healthcare_records\"\n)\n\nSELECT\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(test_results, '_dbt_utils_surrogate_key_null_'))), 2) AS result_key,\n    test_results\nFROM patients\nGROUP BY CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(test_results, '_dbt_utils_surrogate_key_null_'))), 2), \n        test_results;", "relation_name": "\"dbt-fabric project\".\"dbo_staging\".\"stg_test_results\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.579419Z", "completed_at": "2024-01-05T04:58:01.598407Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.603404Z", "completed_at": "2024-01-05T04:58:01.603404Z"}], "thread_id": "Thread-3", "execution_time": 0.03797507286071777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.stg_ward_rooms", "compiled": true, "compiled_code": "WITH patients AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_staging\".\"stg_healthcare_records\"\n)\n\nSELECT\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(room_number, '_dbt_utils_surrogate_key_null_'))), 2) AS room_key,\n    room_number\nFROM patients\nGROUP BY CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(room_number, '_dbt_utils_surrogate_key_null_'))), 2), \n        room_number;", "relation_name": "\"dbt-fabric project\".\"dbo_staging\".\"stg_ward_rooms\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.622392Z", "completed_at": "2024-01-05T04:58:01.645378Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.649375Z", "completed_at": "2024-01-05T04:58:01.649375Z"}], "thread_id": "Thread-3", "execution_time": 0.03597712516784668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.accepted_values_stg_admissions_admission_type__Elective__Emergency__Urgent.1700cd2189", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        admission_type as value_field,\n        count(*) as n_records\n\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_admissions\"\n    group by admission_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Elective','Emergency','Urgent'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.663367Z", "completed_at": "2024-01-05T04:58:01.694347Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.698344Z", "completed_at": "2024-01-05T04:58:01.698344Z"}], "thread_id": "Thread-3", "execution_time": 0.04397106170654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.not_null_stg_admissions_admission_key.479227389d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect admission_key\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_admissions\"\nwhere admission_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.709339Z", "completed_at": "2024-01-05T04:58:01.730325Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.735322Z", "completed_at": "2024-01-05T04:58:01.735322Z"}], "thread_id": "Thread-3", "execution_time": 0.03297853469848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_admissions_admission_key__admission_key__ref_fct_hospital_revenue_.4162fc4117", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select admission_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_admissions\"\n    where admission_key is not null\n),\n\nparent as (\n    select admission_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"fct_hospital_revenue\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.749314Z", "completed_at": "2024-01-05T04:58:01.795284Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.800282Z", "completed_at": "2024-01-05T04:58:01.800282Z"}], "thread_id": "Thread-3", "execution_time": 0.05796360969543457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.unique_stg_admissions_admission_key.28e547849b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    admission_key as unique_field,\n    count(*) as n_records\n\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_admissions\"\nwhere admission_key is not null\ngroup by admission_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.808277Z", "completed_at": "2024-01-05T04:58:01.820270Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.825267Z", "completed_at": "2024-01-05T04:58:01.825267Z"}], "thread_id": "Thread-3", "execution_time": 0.02298736572265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.not_null_stg_diagnosis_diagnosis_key.90086086d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect diagnosis_key\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_diagnosis\"\nwhere diagnosis_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.837259Z", "completed_at": "2024-01-05T04:58:01.849254Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.852250Z", "completed_at": "2024-01-05T04:58:01.852250Z"}], "thread_id": "Thread-3", "execution_time": 0.020986080169677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_diagnosis_diagnosis_key__diagnosis_key__ref_fct_hospital_revenue_.ad37979e74", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select diagnosis_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_diagnosis\"\n    where diagnosis_key is not null\n),\n\nparent as (\n    select diagnosis_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"fct_hospital_revenue\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.861244Z", "completed_at": "2024-01-05T04:58:01.871238Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.874236Z", "completed_at": "2024-01-05T04:58:01.874236Z"}], "thread_id": "Thread-3", "execution_time": 0.017988920211791992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.unique_stg_diagnosis_diagnosis_key.c211a3fe57", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    diagnosis_key as unique_field,\n    count(*) as n_records\n\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_diagnosis\"\nwhere diagnosis_key is not null\ngroup by diagnosis_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.882232Z", "completed_at": "2024-01-05T04:58:01.892225Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.895225Z", "completed_at": "2024-01-05T04:58:01.895225Z"}], "thread_id": "Thread-3", "execution_time": 0.018987417221069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.not_null_stg_doctors_doctor_first_name.b227523acc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect doctor_first_name\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_doctors\"\nwhere doctor_first_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.903221Z", "completed_at": "2024-01-05T04:58:01.912214Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.915213Z", "completed_at": "2024-01-05T04:58:01.915213Z"}], "thread_id": "Thread-3", "execution_time": 0.016991615295410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.not_null_stg_doctors_doctor_key.9a8c67f016", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect doctor_key\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_doctors\"\nwhere doctor_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.923206Z", "completed_at": "2024-01-05T04:58:01.932201Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.934200Z", "completed_at": "2024-01-05T04:58:01.934200Z"}], "thread_id": "Thread-3", "execution_time": 0.016989707946777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.not_null_stg_doctors_doctor_last_name.ebafe9785d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect doctor_last_name\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_doctors\"\nwhere doctor_last_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.942194Z", "completed_at": "2024-01-05T04:58:01.954187Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.958186Z", "completed_at": "2024-01-05T04:58:01.958186Z"}], "thread_id": "Thread-3", "execution_time": 0.02098679542541504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_doctors_doctor_key__doctor_key__ref_fct_hospital_revenue_.abfadf907f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select doctor_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_doctors\"\n    where doctor_key is not null\n),\n\nparent as (\n    select doctor_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"fct_hospital_revenue\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.966179Z", "completed_at": "2024-01-05T04:58:01.977174Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:01.981171Z", "completed_at": "2024-01-05T04:58:01.981171Z"}], "thread_id": "Thread-3", "execution_time": 0.019986391067504883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_doctors_doctor_key__doctor_key__ref_fct_patient_stay_.5095910276", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select doctor_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_doctors\"\n    where doctor_key is not null\n),\n\nparent as (\n    select doctor_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"fct_patient_stay\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:01.990165Z", "completed_at": "2024-01-05T04:58:01.999161Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.003159Z", "completed_at": "2024-01-05T04:58:02.003159Z"}], "thread_id": "Thread-3", "execution_time": 0.01799154281616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.unique_stg_doctors_doctor_key.f4de112248", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    doctor_key as unique_field,\n    count(*) as n_records\n\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_doctors\"\nwhere doctor_key is not null\ngroup by doctor_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.010155Z", "completed_at": "2024-01-05T04:58:02.018066Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.021066Z", "completed_at": "2024-01-05T04:58:02.021066Z"}], "thread_id": "Thread-3", "execution_time": 0.015909910202026367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.dim_healthcare_provider", "compiled": true, "compiled_code": "WITH patients AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_staging\".\"stg_healthcare_records\"\n), \nhospital_details AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_staging\".\"stg_hospitals\"\n)\n\n-- It's possible to have multiple doctors and multiple rooms in a hospital\n\nSELECT  hospital_key,\n        CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(doctor, '_dbt_utils_surrogate_key_null_'))), 2) AS doctor_key,\n        CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(room_number, '_dbt_utils_surrogate_key_null_'))), 2) AS room_key,\n        hospital_name\nFROM patients\nRIGHT JOIN hospital_details\nON patients.hospital = hospital_details.hospital_name\nGROUP BY hospital_key,\n        CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(doctor, '_dbt_utils_surrogate_key_null_'))), 2),\n        CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(room_number, '_dbt_utils_surrogate_key_null_'))), 2),\n        hospital_name", "relation_name": "\"dbt-fabric project\".\"dbo_healthcare\".\"dim_healthcare_provider\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.028324Z", "completed_at": "2024-01-05T04:58:02.043151Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.046158Z", "completed_at": "2024-01-05T04:58:02.046158Z"}], "thread_id": "Thread-3", "execution_time": 0.022836923599243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.not_null_stg_hospitals_hospital_key.acb11395c9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect hospital_key\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_hospitals\"\nwhere hospital_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.055151Z", "completed_at": "2024-01-05T04:58:02.065146Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.069143Z", "completed_at": "2024-01-05T04:58:02.069143Z"}], "thread_id": "Thread-3", "execution_time": 0.01898789405822754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_hospitals_hospital_key__hospital_key__ref_fct_hospital_revenue_.078b794e46", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select hospital_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_hospitals\"\n    where hospital_key is not null\n),\n\nparent as (\n    select hospital_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"fct_hospital_revenue\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.077139Z", "completed_at": "2024-01-05T04:58:02.089130Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.092130Z", "completed_at": "2024-01-05T04:58:02.092130Z"}], "thread_id": "Thread-3", "execution_time": 0.01998591423034668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.unique_stg_hospitals_hospital_key.933cd7e641", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    hospital_key as unique_field,\n    count(*) as n_records\n\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_hospitals\"\nwhere hospital_key is not null\ngroup by hospital_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.099125Z", "completed_at": "2024-01-05T04:58:02.110118Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.113116Z", "completed_at": "2024-01-05T04:58:02.113116Z"}], "thread_id": "Thread-3", "execution_time": 0.01698899269104004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.not_null_stg_insurance_org_insurance_key.1db93b5e67", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect insurance_key\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_insurance_org\"\nwhere insurance_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.121110Z", "completed_at": "2024-01-05T04:58:02.133107Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.136105Z", "completed_at": "2024-01-05T04:58:02.136105Z"}], "thread_id": "Thread-3", "execution_time": 0.019989728927612305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_insurance_org_insurance_key__insurance_key__ref_fct_hospital_revenue_.cb8b7ef2fd", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select insurance_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_insurance_org\"\n    where insurance_key is not null\n),\n\nparent as (\n    select insurance_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"fct_hospital_revenue\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.145099Z", "completed_at": "2024-01-05T04:58:02.154091Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.158092Z", "completed_at": "2024-01-05T04:58:02.158092Z"}], "thread_id": "Thread-3", "execution_time": 0.01899099349975586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.unique_stg_insurance_org_insurance_key.24bbd63b6e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    insurance_key as unique_field,\n    count(*) as n_records\n\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_insurance_org\"\nwhere insurance_key is not null\ngroup by insurance_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.166083Z", "completed_at": "2024-01-05T04:58:02.175896Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.178901Z", "completed_at": "2024-01-05T04:58:02.178901Z"}], "thread_id": "Thread-3", "execution_time": 0.01781487464904785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.not_null_stg_medications_medication_key.257cc1d080", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect medication_key\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_medications\"\nwhere medication_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.189895Z", "completed_at": "2024-01-05T04:58:02.205883Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.209879Z", "completed_at": "2024-01-05T04:58:02.209879Z"}], "thread_id": "Thread-3", "execution_time": 0.02498340606689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_medications_medication_key__medication_key__ref_fct_hospital_revenue_.a723718533", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select medication_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_medications\"\n    where medication_key is not null\n),\n\nparent as (\n    select medication_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"fct_hospital_revenue\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.219873Z", "completed_at": "2024-01-05T04:58:02.231867Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.234865Z", "completed_at": "2024-01-05T04:58:02.234865Z"}], "thread_id": "Thread-3", "execution_time": 0.021984100341796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.unique_stg_medications_medication_key.4d7f01e5a6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    medication_key as unique_field,\n    count(*) as n_records\n\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_medications\"\nwhere medication_key is not null\ngroup by medication_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.243861Z", "completed_at": "2024-01-05T04:58:02.255854Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.258851Z", "completed_at": "2024-01-05T04:58:02.258851Z"}], "thread_id": "Thread-3", "execution_time": 0.01998615264892578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.accepted_values_stg_patient_details_patient_age_category__Infant__Toddler__Child__Adolescent__Adult__Older_Adult.b57fe7685b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        patient_age_category as value_field,\n        count(*) as n_records\n\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_patient_details\"\n    group by patient_age_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Infant','Toddler','Child','Adolescent','Adult','Older Adult'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.269844Z", "completed_at": "2024-01-05T04:58:02.282836Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.286832Z", "completed_at": "2024-01-05T04:58:02.286832Z"}], "thread_id": "Thread-3", "execution_time": 0.02498602867126465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.accepted_values_stg_patient_details_patient_blood_type__O___O___A___A___AB___AB___B___B_.5cd287b4a7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        patient_blood_type as value_field,\n        count(*) as n_records\n\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_patient_details\"\n    group by patient_blood_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'O+','O-','A-','A+','AB-','AB+','B-','B+'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.294830Z", "completed_at": "2024-01-05T04:58:02.304824Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.307821Z", "completed_at": "2024-01-05T04:58:02.307821Z"}], "thread_id": "Thread-3", "execution_time": 0.0179898738861084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.not_null_stg_patient_details_patient_first_name.b271f3a929", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect patient_first_name\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_patient_details\"\nwhere patient_first_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.314817Z", "completed_at": "2024-01-05T04:58:02.327522Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.330529Z", "completed_at": "2024-01-05T04:58:02.330529Z"}], "thread_id": "Thread-3", "execution_time": 0.019710779190063477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.not_null_stg_patient_details_patient_full_name.48d54dac14", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect patient_full_name\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_patient_details\"\nwhere patient_full_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.338524Z", "completed_at": "2024-01-05T04:58:02.349518Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.354514Z", "completed_at": "2024-01-05T04:58:02.354514Z"}], "thread_id": "Thread-3", "execution_time": 0.019986629486083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.not_null_stg_patient_details_patient_key.cc3f43eb4e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect patient_key\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_patient_details\"\nwhere patient_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.362508Z", "completed_at": "2024-01-05T04:58:02.374501Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.378500Z", "completed_at": "2024-01-05T04:58:02.378500Z"}], "thread_id": "Thread-3", "execution_time": 0.020989418029785156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.not_null_stg_patient_details_patient_last_name.5428b64bf0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect patient_last_name\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_patient_details\"\nwhere patient_last_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.388493Z", "completed_at": "2024-01-05T04:58:02.400485Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.404483Z", "completed_at": "2024-01-05T04:58:02.404483Z"}], "thread_id": "Thread-3", "execution_time": 0.02298426628112793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_patient_details_patient_key__patient_key__ref_fct_patient_stay_.c4a4098380", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select patient_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_patient_details\"\n    where patient_key is not null\n),\n\nparent as (\n    select patient_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"fct_patient_stay\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.412479Z", "completed_at": "2024-01-05T04:58:02.424471Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.427470Z", "completed_at": "2024-01-05T04:58:02.427470Z"}], "thread_id": "Thread-3", "execution_time": 0.01998734474182129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.unique_stg_patient_details_patient_key.27c738d398", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    patient_key as unique_field,\n    count(*) as n_records\n\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_patient_details\"\nwhere patient_key is not null\ngroup by patient_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.434464Z", "completed_at": "2024-01-05T04:58:02.445457Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.449453Z", "completed_at": "2024-01-05T04:58:02.449453Z"}], "thread_id": "Thread-3", "execution_time": 0.01898813247680664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.accepted_values_stg_test_results_test_results__Inconclusive__Abnormal__Normal.cbb9294689", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        test_results as value_field,\n        count(*) as n_records\n\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_test_results\"\n    group by test_results\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Inconclusive','Abnormal','Normal'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.458448Z", "completed_at": "2024-01-05T04:58:02.471443Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.475440Z", "completed_at": "2024-01-05T04:58:02.475440Z"}], "thread_id": "Thread-3", "execution_time": 0.02298569679260254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.not_null_stg_test_results_result_key.c8737ca1ea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect result_key\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_test_results\"\nwhere result_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.488431Z", "completed_at": "2024-01-05T04:58:02.501427Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.506421Z", "completed_at": "2024-01-05T04:58:02.506421Z"}], "thread_id": "Thread-3", "execution_time": 0.024985790252685547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_test_results_result_key__result_key__ref_fct_hospital_revenue_.cb796ee445", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select result_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_test_results\"\n    where result_key is not null\n),\n\nparent as (\n    select result_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"fct_hospital_revenue\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.514416Z", "completed_at": "2024-01-05T04:58:02.529406Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.533403Z", "completed_at": "2024-01-05T04:58:02.533403Z"}], "thread_id": "Thread-3", "execution_time": 0.02698206901550293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.unique_stg_test_results_result_key.e663fab7ca", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    result_key as unique_field,\n    count(*) as n_records\n\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_test_results\"\nwhere result_key is not null\ngroup by result_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.548393Z", "completed_at": "2024-01-05T04:58:02.560386Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.564385Z", "completed_at": "2024-01-05T04:58:02.564385Z"}], "thread_id": "Thread-3", "execution_time": 0.02298712730407715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.not_null_stg_ward_rooms_room_key.8a45167580", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect room_key\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_ward_rooms\"\nwhere room_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.573380Z", "completed_at": "2024-01-05T04:58:02.583373Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.588370Z", "completed_at": "2024-01-05T04:58:02.588370Z"}], "thread_id": "Thread-3", "execution_time": 0.021985769271850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.unique_stg_ward_rooms_room_key.f53ece08ff", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    room_key as unique_field,\n    count(*) as n_records\n\nfrom \"dbt-fabric project\".\"dbo_staging\".\"stg_ward_rooms\"\nwhere room_key is not null\ngroup by room_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.596363Z", "completed_at": "2024-01-05T04:58:02.605359Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.608355Z", "completed_at": "2024-01-05T04:58:02.608355Z"}], "thread_id": "Thread-3", "execution_time": 0.01598978042602539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fabricdemo.dim_patients", "compiled": true, "compiled_code": "WITH patients AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_staging\".\"stg_healthcare_records\"\n), \npatient_details AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_staging\".\"stg_patient_details\"\n),\ndate_cte AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_healthcare\".\"dim_date\"\n),\nhospitals AS (\n    SELECT * FROM \"dbt-fabric project\".\"dbo_healthcare\".\"dim_healthcare_provider\"\n)\n\n-- Assuming that there can be patients that could visit the hospital more than once\nSELECT  \n    patient_key,\n    hospital_key,\n    date_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(admission_type, '_dbt_utils_surrogate_key_null_'))), 2) AS admission_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medical_condition, '_dbt_utils_surrogate_key_null_'))), 2) AS diagnosis_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(insurance_provider, '_dbt_utils_surrogate_key_null_'))), 2) AS insurance_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medication, '_dbt_utils_surrogate_key_null_'))), 2) AS medication_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(test_results, '_dbt_utils_surrogate_key_null_'))), 2) AS result_key,\n    patient_first_name,\n    patient_last_name,\n    patient_age,\n    patient_age_category,\n    patient_gender,\n    patient_blood_type,\n    admission_date,\n    discharge_date\nFROM patients\nINNER JOIN date_cte ON date_cte.full_date = patients.admission_date\nRIGHT JOIN patient_details ON patients.name = patient_details.patient_full_name\nINNER JOIN hospitals ON patients.hospital = hospitals.hospital_name\nGROUP BY  \n    patient_key,\n    hospital_key,\n    date_key,\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(admission_type, '_dbt_utils_surrogate_key_null_'))), 2),\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medical_condition, '_dbt_utils_surrogate_key_null_'))), 2),\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(insurance_provider, '_dbt_utils_surrogate_key_null_'))), 2),\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(medication, '_dbt_utils_surrogate_key_null_'))), 2),\n    CONVERT(VARCHAR(32), HASHBYTES('MD5', CONVERT(VARBINARY(MAX), COALESCE(test_results, '_dbt_utils_surrogate_key_null_'))), 2),\n    patient_first_name,\n    patient_last_name,\n    patient_age,\n    patient_age_category,\n    patient_gender,\n    patient_blood_type,\n    admission_date,\n    discharge_date", "relation_name": "\"dbt-fabric project\".\"dbo_healthcare\".\"dim_patients\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.615353Z", "completed_at": "2024-01-05T04:58:02.628344Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.632342Z", "completed_at": "2024-01-05T04:58:02.632342Z"}], "thread_id": "Thread-3", "execution_time": 0.021985292434692383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_doctors_doctor_key__doctor_key__ref_dim_healthcare_provider_.2c09be5642", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select doctor_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_doctors\"\n    where doctor_key is not null\n),\n\nparent as (\n    select doctor_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"dim_healthcare_provider\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.640337Z", "completed_at": "2024-01-05T04:58:02.651330Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.655330Z", "completed_at": "2024-01-05T04:58:02.655330Z"}], "thread_id": "Thread-3", "execution_time": 0.020989418029785156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_hospitals_hospital_key__hospital_key__ref_dim_healthcare_provider_.1240e23fc5", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select hospital_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_hospitals\"\n    where hospital_key is not null\n),\n\nparent as (\n    select hospital_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"dim_healthcare_provider\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.664323Z", "completed_at": "2024-01-05T04:58:02.677316Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.681312Z", "completed_at": "2024-01-05T04:58:02.681312Z"}], "thread_id": "Thread-3", "execution_time": 0.022985219955444336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_ward_rooms_room_key__room_key__ref_dim_healthcare_provider_.7c2b7fd759", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select room_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_ward_rooms\"\n    where room_key is not null\n),\n\nparent as (\n    select room_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"dim_healthcare_provider\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.693307Z", "completed_at": "2024-01-05T04:58:02.706297Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.709296Z", "completed_at": "2024-01-05T04:58:02.709296Z"}], "thread_id": "Thread-3", "execution_time": 0.021986007690429688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_admissions_admission_key__admission_key__ref_dim_patients_.493f3c9440", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select admission_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_admissions\"\n    where admission_key is not null\n),\n\nparent as (\n    select admission_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"dim_patients\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.716290Z", "completed_at": "2024-01-05T04:58:02.728283Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.731450Z", "completed_at": "2024-01-05T04:58:02.731450Z"}], "thread_id": "Thread-3", "execution_time": 0.018166065216064453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_diagnosis_diagnosis_key__diagnosis_key__ref_dim_patients_.ef42164d53", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select diagnosis_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_diagnosis\"\n    where diagnosis_key is not null\n),\n\nparent as (\n    select diagnosis_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"dim_patients\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.738452Z", "completed_at": "2024-01-05T04:58:02.750442Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.754441Z", "completed_at": "2024-01-05T04:58:02.754441Z"}], "thread_id": "Thread-3", "execution_time": 0.01998734474182129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_insurance_org_insurance_key__insurance_key__ref_dim_patients_.0d12e55c8c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select insurance_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_insurance_org\"\n    where insurance_key is not null\n),\n\nparent as (\n    select insurance_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"dim_patients\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.761438Z", "completed_at": "2024-01-05T04:58:02.772431Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.775430Z", "completed_at": "2024-01-05T04:58:02.775430Z"}], "thread_id": "Thread-3", "execution_time": 0.018986940383911133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_medications_medication_key__medication_key__ref_dim_patients_.d25a916ece", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select medication_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_medications\"\n    where medication_key is not null\n),\n\nparent as (\n    select medication_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"dim_patients\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.783424Z", "completed_at": "2024-01-05T04:58:02.794415Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.797415Z", "completed_at": "2024-01-05T04:58:02.797415Z"}], "thread_id": "Thread-3", "execution_time": 0.01898813247680664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_patient_details_patient_key__patient_key__ref_dim_patients_.b052bb2878", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select patient_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_patient_details\"\n    where patient_key is not null\n),\n\nparent as (\n    select patient_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"dim_patients\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-05T04:58:02.805408Z", "completed_at": "2024-01-05T04:58:02.817718Z"}, {"name": "execute", "started_at": "2024-01-05T04:58:02.821721Z", "completed_at": "2024-01-05T04:58:02.821721Z"}], "thread_id": "Thread-3", "execution_time": 0.020306825637817383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fabricdemo.relationships_stg_test_results_result_key__result_key__ref_dim_patients_.41da1bbeaa", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select result_key as from_field\n    from \"dbt-fabric project\".\"dbo_staging\".\"stg_test_results\"\n    where result_key is not null\n),\n\nparent as (\n    select result_key as to_field\n    from \"dbt-fabric project\".\"dbo_healthcare\".\"dim_patients\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}], "elapsed_time": 20.43931818008423, "args": {"indirect_selection": "eager", "printer_width": 80, "log_level": "info", "version_check": true, "enable_legacy_logger": false, "select": [], "which": "generate", "log_format_file": "debug", "show_resource_report": false, "cache_selected_only": false, "log_file_max_bytes": 10485760, "log_path": "C:\\Users\\USER\\.dbt\\fabricdemo\\logs", "send_anonymous_usage_stats": true, "macro_debugging": false, "vars": {}, "write_json": true, "partial_parse": true, "log_level_file": "debug", "use_colors": true, "strict_mode": false, "exclude": [], "static_parser": true, "partial_parse_file_diff": true, "project_dir": "C:\\Users\\USER\\.dbt\\fabricdemo", "use_colors_file": true, "empty_catalog": false, "invocation_command": "dbt docs generate", "populate_cache": true, "log_format": "default", "favor_state": false, "defer": false, "print": true, "profiles_dir": "C:\\Users\\USER\\.dbt\\fabricdemo", "warn_error_options": {"include": [], "exclude": []}, "quiet": false, "compile": true, "introspect": true, "static": false}}